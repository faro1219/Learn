
% !TEX TS-program = Asymptote

\usepackage{comment} % enables the use of multi-line comments (\ifx \fi) 
\usepackage{lipsum}
\usepackage{cabin}
\usepackage{fullpage} 
\usepackage[margin=0.5in]{geometry} 
\usepackage[english]{babel}
\usepackage[utf8]{inputenc}
\usepackage[framemethod=TikZ]{mdframed}
\usepackage{amsmath}
\usepackage{amsthm}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{mathtools}
\usepackage{mathabx}
\usepackage{listings}
\usepackage{thmtools}
\usepackage{bm}
\usepackage{natbib}
\usepackage{enumitem}  
\usepackage{stackrel}
\usepackage{mathtools}
\usepackage{mathrsfs}
\usepackage{dsfont}
\usepackage{float}
\usepackage{graphicx}
\usepackage{subfigure}
\usepackage{hyperref}
\usepackage{cleveref}
\usepackage{pgfplots}
\usetikzlibrary{backgrounds}
\pgfplotsset{width=7cm,compat=1.9}
\usepackage{tikz-cd} 
\usepackage{import}
\usepackage{pdfpages}
\usepackage{transparent}
\usepackage{stmaryrd}
\usepackage{textcase}
\usepackage{asymptote}
\usepackage{etoolbox}
\usepackage{footnotebackref}
\usepackage{pgffor}
\usepackage{fancyhdr}
\usepackage{array,booktabs}
\usepackage[
  open,
  openlevel=2,
  atend,
  numbered
]{bookmark}
\providecommand{\willpdftitle}{notes}
\hypersetup{
	pdftitle={\willpdftitle},
}


%% Algorithm setting 
\usepackage[linesnumbered,ruled,vlined, algochapter]{algorithm2e}
\SetKwInput{KwInput}{Input}                % Set the Input
\SetKwInput{KwInit}{Initialize}                % Set the Input

%% Table Setting 
\usepackage{stackengine}
\newcommand\xrowht[2][0]{\addstackgap[.5\dimexpr#2\relax]{\vphantom{#1}}}


%% Code style 
\definecolor{backcolour}{rgb}{0.95,0.95,0.92}
\definecolor{codegreen}{rgb}{0,0.6,0}

% Define a custom style
\lstdefinestyle{myStyle}{
    % backgroundcolor=\color{backcolour},   
    commentstyle=\color{codegreen},
    basicstyle=\ttfamily\footnotesize,
    breakatwhitespace=false,         
    breaklines=true,                 
    keepspaces=true,                 
    numbers=left,       
    numbersep=5pt,                  
    showspaces=false,                
    showstringspaces=false,
    showtabs=false,                  
    tabsize=2,
}
\usepackage{minibox}
\newcommand*{\explain}[1]{\hfill\minibox[l]{\textcolor{gray}{#1}}}%
\lstset{language=C++,basicstyle=\small\sffamily,
  numbers=none,
  frame=tb,
  columns=fullflexible,
  showstringspaces=false,
  moredelim=[is][\color{red}]{|}{|},
  escapechar=\&% char to escape out of listings and back to LaTeX
}

% Use \lstset to make myStyle the global default
\lstset{style=myStyle}

%% Title Setting
\newcommand\subtitle[1]{\def \@subtitle{#1}}
\newcommand\lecturer[1]{\def \@lecturer{#1}}
\renewcommand\maketitle
  {\vspace{-2em}
  \hrule
  \vspace{1em}
  \noindent
   {\Huge\bfseries\@title \hfill}%
   \medskip\par\noindent
   \@ifundefined{@subtitle}{}
   {\noindent
   {\huge\bfseries\@subtitle \hfill}
   
   \vspace{1em}
   }
   \medskip\par {\noindent
   {\large{Lecturer:} \large\bfseries\@lecturer \hfill}}%
   \vspace{-0.4em}
   \medskip\par {\noindent
   {\large{Subscribes:} \large\bfseries\@author \hfill}}%
   \vspace{-0.4em}
   \medskip\par \noindent
   {\large\@date \hfill}%
   \bigskip\par\noindent
   \hrule
   \vspace{1em}
  }

%% Bibliography 



%% Section settings
\usepackage[Glenn]{fncychap}

%% Hyperlink settings
\hypersetup{
colorlinks,
linkcolor=[RGB]{65,105,225},
citecolor=[RGB]{65,105,225},
urlcolor=[RGB]{65,105,225}
}

%% Mathcal commends
\newcommand{\cA}{\mathcal{A}}
\newcommand{\cB}{\mathcal{B}}
\newcommand{\cC}{\mathcal{C}}
\newcommand{\cD}{\mathcal{D}}
\newcommand{\cE}{\mathcal{E}}
\newcommand{\cF}{\mathcal{F}}
\newcommand{\cG}{\mathcal{G}}
\newcommand{\cH}{\mathcal{H}}
\newcommand{\cI}{\mathcal{I}}
\newcommand{\cJ}{\mathcal{J}}
\newcommand{\cK}{\mathcal{K}}
\newcommand{\cL}{\mathcal{L}}
\newcommand{\cM}{\mathcal{M}}
\newcommand{\cN}{\mathcal{N}}
\newcommand{\cO}{\mathcal{O}}
\newcommand{\cP}{\mathcal{P}}
\newcommand{\cQ}{\mathcal{Q}}
\newcommand{\cR}{\mathcal{R}}
\newcommand{\cS}{\mathcal{S}}
\newcommand{\cT}{\mathcal{T}}
\newcommand{\cU}{\mathcal{U}}
\newcommand{\cV}{\mathcal{V}}
\newcommand{\cW}{\mathcal{W}}
\newcommand{\cX}{\mathcal{X}}
\newcommand{\cY}{\mathcal{Y}}
\newcommand{\cZ}{\mathcal{Z}}

%% Mathbb commends
\newcommand{\BB}{\mathbb{B}}
\newcommand{\CC}{\mathbb{C}}
\newcommand{\DD}{\mathbb{D}}
\newcommand{\EE}{\mathbb{E}}
\newcommand{\FF}{\mathbb{F}}
\newcommand{\GG}{\mathbb{G}}
\newcommand{\HH}{\mathbb{H}}
\newcommand{\II}{\mathbb{I}}
\newcommand{\JJ}{\mathbb{J}}
\newcommand{\KK}{\mathbb{K}}
\newcommand{\LL}{\mathbb{L}}
\newcommand{\MM}{\mathbb{M}}
\newcommand{\NN}{\mathbb{N}}
\newcommand{\OO}{\mathbb{O}}
\newcommand{\PP}{\mathbb{P}}
\newcommand{\QQ}{\mathbb{Q}}
\newcommand{\RR}{\mathbb{R}}
\newcommand{\TT}{\mathbb{T}}
\newcommand{\UU}{\mathbb{U}}
\newcommand{\VV}{\mathbb{V}}
\newcommand{\WW}{\mathbb{W}}
\newcommand{\XX}{\mathbb{X}}
\newcommand{\YY}{\mathbb{Y}}
\newcommand{\ZZ}{\mathbb{Z}}

%% Mathbf commends
\newcommand{\Ab}{\mathbf{A}}
\newcommand{\Bb}{\mathbf{B}}
\newcommand{\Cb}{\mathbf{C}}
\newcommand{\Db}{\mathbf{D}}
\newcommand{\Eb}{\mathbf{E}}
\newcommand{\Fb}{\mathbf{F}}
\newcommand{\Gb}{\mathbf{G}}
\newcommand{\Hb}{\mathbf{H}}
\newcommand{\Ib}{\mathbf{I}}
\newcommand{\Jb}{\mathbf{J}}
\newcommand{\Kb}{\mathbf{K}}
\newcommand{\Lb}{\mathbf{L}}
\newcommand{\Mb}{\mathbf{M}}
\newcommand{\Nb}{\mathbf{N}}
\newcommand{\Ob}{\mathbf{O}}
\newcommand{\Pb}{\mathbf{P}}
\newcommand{\Qb}{\mathbf{Q}}
\newcommand{\Rb}{\mathbf{R}}
\newcommand{\Sbb}{\mathbf{S}}
\newcommand{\Tb}{\mathbf{T}}
\newcommand{\Ub}{\mathbf{U}}
\newcommand{\Vb}{\mathbf{V}}
\newcommand{\Wb}{\mathbf{W}}
\newcommand{\Xb}{\mathbf{X}}
\newcommand{\Yb}{\mathbf{Y}}
\newcommand{\Zb}{\mathbf{Z}}
\newcommand{\ab}{\mathbf{a}}
\newcommand{\bbb}{\mathbf{b}}
\newcommand{\cbb}{\mathbf{c}}
\newcommand{\db}{\mathbf{d}}
\newcommand{\eb}{\mathbf{e}}
\newcommand{\fb}{\mathbf{f}}
\newcommand{\gb}{\mathbf{g}}
\newcommand{\hb}{\mathbf{h}}
\newcommand{\ib}{\mathbf{i}}
\newcommand{\jb}{\mathbf{j}}
\newcommand{\kb}{\mathbf{k}}
\newcommand{\lb}{\mathbf{l}}
\newcommand{\mb}{\mathbf{m}}
\newcommand{\nbb}{\mathbf{n}}
\newcommand{\ob}{\mathbf{o}}
\newcommand{\pb}{\mathbf{p}}
\newcommand{\qb}{\mathbf{q}}
\newcommand{\rb}{\mathbf{r}}
\newcommand{\sbb}{\mathbf{s}}
\newcommand{\tb}{\mathbf{t}}
\newcommand{\ub}{\mathbf{u}}
\newcommand{\vb}{\mathbf{v}}
\newcommand{\wb}{\mathbf{w}}
\newcommand{\xb}{\mathbf{x}}
\newcommand{\yb}{\mathbf{y}}
\newcommand{\zb}{\mathbf{z}}

%% Enumerate settings
\setenumerate[1]{itemsep=0pt,partopsep=0pt,parsep=\parskip,topsep=5pt}  
\setitemize[1]{itemsep=0pt,partopsep=0pt,parsep=\parskip,topsep=5pt}  
\setdescription{itemsep=0pt,partopsep=0pt,parsep=\parskip,topsep=5pt}  
\newlist{listalph}{enumerate}{1}
\setlist[listalph,1]{label=(\alph*)}
\newlist{listroman}{enumerate}{1}
\setlist[listroman,1]{label=(\roman*)}

%% Colors
\definecolor{lbrown}{HTML}{FEFCFB}
\definecolor{mbrown}{HTML}{8b0000}
\definecolor{mdbrown}{HTML}{b58260}
\definecolor{dbrown}{HTML}{964007}
\definecolor{lgreen}{HTML}{f9fffc}
\definecolor{dgreen}{HTML}{009956}
\definecolor{ddgreen}{HTML}{00ff00}
\definecolor{llblue}{HTML}{f9ffff}
\definecolor{lblue}{HTML}{f9ffff}
\definecolor{dblue}{HTML}{1e90ff}
\definecolor{violet}{HTML}{7F00FF}
\definecolor{lvlet}{HTML}{f5ebff}
% \definecolor{yellow}{HTML}{F4C430}
\definecolor{yellow}{HTML}{ffd700}
\definecolor{lyellow}{HTML}{fffff9}
\definecolor{dred}{HTML}{c60000}
\definecolor{red}{HTML}{ff3e3e}
\definecolor{lred}{HTML}{ffeded}
\definecolor{llred}{HTML}{fff9f9}

%% Theorem styles
%% Theorem styles
\declaretheoremstyle[
  headfont=\color{dbrown}\sffamily\bfseries,
  bodyfont=\color{black}\normalfont,
  % headindent = \parindent,
%postheadhook = {\hspace*{\parindent}},
postheadspace = \newline, 
  mdframed={
    linewidth=2pt,
    innerbottommargin = 0.2cm,
    rightline=false, topline=false, bottomline=false,
    linecolor=dbrown, backgroundcolor=lbrown,
  }
]{coloredthm1}

\declaretheoremstyle[
  headfont=\color{mdbrown}\sffamily\bfseries,
  bodyfont=\color{black}\normalfont,
  % headindent = \parindent,
%postheadhook = {\hspace*{\parindent}},
postheadspace = \newline, 
  mdframed={
    linewidth=2pt,
    innerbottommargin = 0.2cm,
    rightline=false, topline=false, bottomline=false,
    linecolor=mdbrown, backgroundcolor=lbrown,
  }
]{coloredthm}

\declaretheoremstyle[
  headfont=\color{red}\sffamily\bfseries,
  bodyfont=\color{black}\normalfont,
  % headindent = \parindent,
%postheadhook = {\hspace*{\parindent}},
postheadspace = \newline, 
  mdframed={
    linewidth=2pt,
    innerbottommargin = 0.2cm,
    rightline=false, topline=false, bottomline=false,
    linecolor=red, backgroundcolor=llred,
  }
]{coloredpb}

\declaretheoremstyle[
  headfont=\color{dbrown}\sffamily\bfseries,
  bodyfont=\color{black}\normalfont,
  postheadspace = \newline, 
  mdframed={
    linewidth=2pt,
    innerbottommargin = 0.2cm,
    rightline=false, topline=false, bottomline=false,
    linecolor=dbrown, backgroundcolor=lbrown,
  }
]{coloredproof}

\declaretheoremstyle[
  headfont=\color{dblue}\sffamily\bfseries,
  bodyfont=\color{black}\normalfont,
  postheadspace = \newline, 
  mdframed={
    linewidth=2pt,
    innerbottommargin = 0.2cm,
    rightline=false, topline=false, bottomline=false,
    linecolor=dblue, backgroundcolor=llblue,
  }
]{coloredexplanation}

\declaretheoremstyle[
  headfont=\color{dgreen}\sffamily\bfseries,
  bodyfont=\color{black}\normalfont,
  postheadspace = \newline, 
  mdframed={
    linewidth=2pt,
    innerbottommargin = 0.2cm,
    rightline=false, topline=false, bottomline=false,
    linecolor=dgreen, backgroundcolor=lgreen,
  }
]{coloreddef}

\declaretheoremstyle[
  headfont=\color{dblue}\sffamily\bfseries,
  bodyfont=\color{black}\normalfont,
  postheadspace = \newline,
  mdframed={
    linewidth=2pt,
    innerbottommargin = 0.2cm,
    rightline=false, topline=false, bottomline=false,
    linecolor=dblue, backgroundcolor=lblue,
  }
]{coloredeg}

\declaretheoremstyle[
  headfont=\color{yellow}\sffamily\bfseries,
  bodyfont=\color{black}\normalfont,
  postheadspace = \newline,
  mdframed={
    linewidth=2pt,
    innerbottommargin = 0.2cm,
    rightline=false, topline=false, bottomline=false,
    linecolor=yellow, backgroundcolor=lyellow,
  }
]{coloredremark}

%% Matrix formats 
\makeatletter
\renewcommand*\env@matrix[1][\arraystretch]{%
  \edef\arraystretch{#1}%
  \hskip -\arraycolsep
  \let\@ifnextchar\new@ifnextchar
  \array{*\c@MaxMatrixCols c}}
\makeatother

%% Theorem formats
\declaretheorem[
  style=coloredthm1,
  name=Theorem,
  numberwithin=chapter,
]{theorem}
\declaretheorem[
  style=coloredthm,
  name=Proposition,
  sibling=theorem,
]{proposition}
\declaretheorem[
  style=coloredthm,
  name=Lemma,
  sibling=theorem,
]{lemma}
\declaretheorem[
  style=coloredthm,
  name=Corollary,
  sibling=theorem,
]{corollary}
\declaretheorem[
  style=coloredproof,
  name=Proof,
  numbered=no,
]{replacementproof}
% \renewenvironment{proof}[1][\proofname]{\vspace{-17pt}\begin{replacementproof}}{\end{replacementproof}}
\makeatletter
\renewenvironment{proof}[1][\proofname]{\par
  \pushQED{\qed}%
  \normalfont \topsep6\p@\@plus6\p@\relax
  \trivlist
  \item[\hskip\labelsep
        \itshape
    #1\@addpunct{.}]\mbox{}~\\
}{%
  \popQED\endtrivlist\@endpefalse
}
\makeatother
\declaretheorem[
  style=coloreddef,
  name=Definition,
  sibling=theorem,
]{definition}

\declaretheorem[
  style=coloredremark,
  name=Notation,
  sibling=theorem,
]{notation}


\declaretheorem[
  style=coloredeg,
  name=Example,
  sibling=theorem,
]{example}
\declaretheorem[
  style=coloredremark,
  name=Remark,
  sibling=theorem,
]{remark}
\declaretheorem[
  style=coloredremark,
  name=Note,
  sibling=theorem,
]{note}
\declaretheorem[
  style=coloredeg,
  name=Conjecture,
  sibling=theorem,
]{conjecture}

\declaretheorem[
  style=coloredpb,
  name=Problem,
  sibling=theorem,
]{problem}

% \tcbuselibrary{breakable}
% \newenvironment{verbetering}{\begin{tcolorbox}[
%     arc=0mm,
%     colback=white,
%     colframe=green!60!black,
%     title=Opmerking,
%     fonttitle=\sffamily,
%     breakable
% ]}{\end{tcolorbox}}


%% Other Settings
\newcommand{\argmin}{\mathop{\mathrm{argmin}}}
\newcommand{\argmax}{\mathop{\mathrm{argmax}}}
\newcommand{\minimize}{\mathop{\mathrm{minimize}}}
\newcommand{\sign}{\mathop{\mathrm{sign}}}
\newcommand{\tr}{\mathop{\mathrm{tr}}}
\newcommand*{\zero}{{\bm 0}}
\newcommand*{\one}{{\bm 1}}
\newcommand{\smallfrac}[2]{{\textstyle \frac{#1}{#2}}}  
\newcommand{\diag}{{\rm diag}}

\newcommand*{\frob}[1]{\|#1\|_{\mathrm{F}}}
\newcommand*{\two}[1]{\|#1\|_{2}}
\newcommand{\Exp}{\text{Exp}}

\newcommand{\wc}{{\textcolor{red}{[\textbf{Will: Todo} ]}}}
\newcommand{\QA}{{\textcolor{green}{[ ]}}}
\DeclareMathOperator{\Var}{{\rm Var}}

\DeclareMathOperator{\supp}{{\rm supp}}
\DeclareMathOperator{\im}{{\rm Im}}
\DeclareMathOperator{\Cor}{\rm Corr}
\DeclareMathOperator{\Cov}{\rm Cov}
\DeclareMathOperator{\ind}{\mathds{1}}  % Indicator
\DeclareMathOperator{\con}{C}
\DeclareMathOperator{\Lip}{Lip}
\DeclareMathOperator{\Supp}{supp}


%% Applied Math Setting 
\DeclareMathOperator{\fl}{fl}
\newcommand{\mep}{\epsilon_{\text{machine}}}

%% Category theory setting 
\DeclareMathOperator{\range}{range}
\DeclareMathOperator{\nul}{null}
%% Geometry Setting 
\DeclareMathOperator{\GL}{GL}
\DeclareMathOperator{\SL}{SL}
\DeclareMathOperator{\SU}{SU}
\DeclareMathOperator{\SO}{SO}
\DeclareMathOperator{\gl}{gl}
\DeclareMathOperator{\U}{U}
\DeclareMathOperator{\lie}{Lie}

%% Vim Settings
\newcommand{\incfig}[2][1]{%
    \def\svgwidth{#1\columnwidth}
    \import{./figures/}{#2.pdf_tex}
}

\pdfsuppresswarningpagegroup=1
                                            
% Algebra Setting 
\DeclareMathOperator{\Gal}{Gal}
\DeclareMathOperator{\Aut}{Aut}
\newcommand{\id}{\operatorname{id}}
\DeclareMathOperator{\Chara}{char}
\DeclareMathOperator{\V}{V}
\DeclareMathOperator{\I}{I}
\DeclareMathOperator{\D}{D}
\newcommand{\limit}{\varprojlim}
\newcommand{\colimit}{\varinjlim}
\DeclareMathOperator{\spec}{Spec}
\newcommand{\ip}{\mathfrak{p}}
\newcommand{\iq}{\mathfrak{q}}
\newcommand{\strs}[1]{\cO_{\spec #1}}
\DeclareMathOperator{\res}{res}
\DeclareMathOperator{\sh}{sh}
\newcommand{\op}[1]{\operatorname{#1}}
\newcommand{\mf}[1]{\mathfrak{#1}}
\newcommand{\mc}[1]{\mathcal{#1}}
\newcommand{\coker}{\operatorname{coker}}
\newcommand{\sgn}{\operatorname{sgn}}
\newcommand{\rad}{\operatorname{rad}}
\newcommand{\into}{\hookrightarrow}
\newcommand{\onto}{\twoheadrightarrow}
\newcommand{\opp}{^\mathrm{op}}

% Stat setting 
\newcommand{\var}{\mathrm{Var}}
\newcommand{\err}{\mathrm{Err}}
% Title Page 
\definecolor{HR}{RGB}{65,105,225}

\usepackage{fix-cm}    

\makeatletter
\newcommand\HUGE{\@setfontsize\Huge{35}{35}}
\makeatother  
%%% Coverpage 
\definecolor{UnivColor}{RGB}{65,105,225}
\newcommand{\coverpage}{%
\pagestyle{empty}
    \begin{flushright}
	\begin{tabular}{ll}
	\raisebox{-.5\height}{\includegraphics[width=25em]{\imagename}} & {\color{UnivColor} } \\
	\end{tabular}
    \end{flushright}
\vspace{2in}
{  \Huge \noindent\coursenum \par\vspace{0.2cm}\noindent {\bfseries\coursename} \par\vspace{-0.3cm} \noindent\rule{0.8\textwidth}{0.05cm}\par\vspace{0.4cm}}
\ifdefined\professor 
{ \Large \noindent Professor: \professor \par \noindent Notes By: \student}
\else 
{ \Large \noindent Notes By: \student}
\fi
\vfill
\begin{center} {\huge \semesteryear} \end{center}
}

\newcommand{\updated}[1]{%
\newpage
\vspace*{\fill} 
    \begin{quote} 
    \centering 
    Last Updated: #1 
    \end{quote}
\vspace*{\fill}
\newpage
}

\newcommand{\nirideasymbol}{%
	\begin{tikzpicture}[baseline=(x.base)]
		\draw[rounded corners=.01em] (-.05em,-1.07em)rectangle(.05em,.78em);
		\draw[fill=white,rounded corners=1.3] (0,.75em)--(.75em,0)--(0,-.75em)--(-.75em,0)--cycle;
		\draw[line width=0.2mm, line cap=round](-.4em,-1.07em)--(.4em,-1.07em);
		\node(x) at (0,0em) {};
		\node at (0,0em) {{\cabin\textbf{!}}};
	\end{tikzpicture}%
}

\newcommand{\nirwarnsymbol}{%
	\begin{tikzpicture}[baseline=(x.base)]
		\draw[rounded corners=.01em] (-.05em,-1.07em)rectangle(.05em,.78em);
		\draw[fill=white,rounded corners=1.3] (0,.75em)--(.75em,0)--(0,-.75em)--(-.75em,0)--cycle;
		\draw[line width=0.2mm, line cap=round](-.4em,-1.07em)--(.4em,-1.07em);
		\node(x) at (0,0em) {};
		% Thank you https://tex.stackexchange.com/a/262510
		\draw[
			line cap=but,
			line join=round,
			x=.5em,
			line width=0.5mm,
			y=1*(height("Z")-\pgflinewidth)*(1-sin(10)),
			rotate=-10,
			rounded corners=1.5pt,
		](-0.57, 0.57) -- (0.57, 0.57) -- (-0.57, -0.57) -- (0.57, -0.57);
	\end{tikzpicture}%
}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% MARGINS
\usepackage{marginnote}
% Thank you https://tex.stackexchange.com/a/472882
% Makes marginnotes always appear on the left, apparently
%
\makeatletter
\long\def\@mn@@@marginnote[#1]#2[#3]{%
	\begingroup
		\ifmmode\mn@strut\let\@tempa\mn@vadjust\else
			\if@inlabel\leavevmode\fi
			\ifhmode\mn@strut\let\@tempa\mn@vadjust\else\let\@tempa\mn@vlap\fi
		\fi
		\@tempa{%
			\vbox to\z@{%
				\vss
				\@mn@margintest
				\if@reversemargin\if@tempswa
						\@tempswafalse
					\else
						\@tempswatrue
				\fi\fi

					\llap{%
						\vbox to\z@{\kern\marginnotevadjust\kern #3
							\vbox to\z@{%
								\hsize\marginparwidth
								\linewidth\hsize
								\kern-\parskip
								%\mn@parboxrestore
								\marginfont\raggedleftmarginnote\strut\hspace{\z@}%
								\ignorespaces#1\endgraf
								\vss
							}%
							\vss
						}%
						\if@mn@verbose
							\PackageInfo{marginnote}{xpos seems to be \@mn@currxpos}%
						\fi
						\begingroup
							\ifx\@mn@currxpos\relax\else\ifx\@mn@currpos\@empty\else
									\kern\@mn@currxpos
							\fi\fi
							\ifx\@mn@currpage\relax
								\let\@mn@currpage\@ne
							\fi
							\if@twoside\ifodd\@mn@currpage\relax
									\kern-\oddsidemargin
								\else
									\kern-\evensidemargin
								\fi
							\else
								\kern-\oddsidemargin
							\fi
							\kern-1in
						\endgroup
						\kern\marginparsep
					}%
			}%
		}%
	\endgroup
}
\makeatother
%
% Mostly for todonotes
\renewcommand{\marginpar}{\marginnote}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% /MARGINS


\definecolor{nirlightred}{HTML}{faf6ff}
\definecolor{nirdarkred}{HTML}{5d00bb}
\declaretheoremstyle[
  postheadspace = \newline, 
	mdframed={
		backgroundcolor=nirlightred,
		linecolor=nirdarkred,
		rightline=false,
		topline=false,
		bottomline=false,
		linewidth=2pt,
		innertopmargin=5pt,
		innerbottommargin=8pt,
		innerleftmargin=8pt,
		leftmargin=-2pt,
		skipbelow=2pt,
		nobreak
	},
  headfont=\color{nirdarkred}\sffamily\bfseries,
]{nirredbox}



\makeatletter
\declaretheorem[
	style=nirredbox,
	name=Idea,
	sibling=theorem,
	% without \leavevmode, the first item in a list gets misformatted
	postheadhook={\leavevmode\marginnote{\nirideasymbol}[-3pt]%
	\ifthmt@thisistheone% restatable makes alignment weird
		\hspace{-2.2pt}%
	\fi}
]{idea}

\declaretheorem[
	style=nirredbox,
	name=Warning,
	sibling=theorem,
	% without \leavevmode, the first item in a list gets misformatted
	postheadhook={\leavevmode\marginnote{\nirwarnsymbol}[-3pt]%
	\ifthmt@thisistheone% restatable makes alignment weird
		\hspace{-2.2pt}%
	\fi}
]{warn}
\makeatother



%% Tikz setting 
\tikzstyle{process} = [rectangle, draw, text centered, rounded corners, minimum height=2em]
\def\$#1\${\begin{align*}#1\end{align*}}